

## 1ï¸âƒ£ å…¨æ™¯å›¾ï¼šMemory ç³»ç»Ÿçš„æ•´ä½“æ¶æ„

å…ˆçœ‹ä¸€å¼ å®Œæ•´çš„åœ°å›¾ï¼Œåé¢æ‰€æœ‰å†…å®¹éƒ½åœ¨è¿™å¼ å›¾é‡Œï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ LangGraph Memory â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  çŸ­æœŸè®°å¿†     â”‚         â”‚  é•¿æœŸè®°å¿†                 â”‚  â”‚
â”‚  â”‚  (State)     â”‚         â”‚  (Store)                 â”‚  â”‚
â”‚  â”‚              â”‚         â”‚                          â”‚  â”‚
â”‚  â”‚  Thread èŒƒå›´  â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  Checkpointerâ”‚         â”‚  â”‚è¯­ä¹‰è®°å¿† â”‚ â”‚æƒ…æ™¯è®°å¿† â”‚   â”‚  â”‚
â”‚  â”‚              â”‚         â”‚  â”‚(äº‹å®)  â”‚ â”‚(ç»éªŒ)  â”‚   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚                           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚
â”‚                           â”‚  â”‚ç¨‹åºè®°å¿† â”‚  å†™å…¥æ–¹å¼ï¼š   â”‚  â”‚
â”‚                           â”‚  â”‚(è§„åˆ™)  â”‚  â€¢ Hot Path  â”‚  â”‚
â”‚                           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ Backgroundâ”‚  â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2ï¸âƒ£ çŸ­æœŸè®°å¿†

ä¸Šæ¬¡è®²äº†åŸºæœ¬æ¦‚å¿µï¼Œè¿™æ¬¡è¡¥å……**ç®¡ç†ç­–ç•¥çš„æ ¸å¿ƒæ€æƒ³**ã€‚

### é—®é¢˜æœ¬è´¨

```
å¯¹è¯è¶Šæ¥è¶Šé•¿ â†’ æ¶ˆæ¯åˆ—è¡¨ä¸æ–­å¢é•¿ â†’ ä¸‰ä¸ªç‚¸å¼¹ğŸ’£
```

| ğŸ’£ é—®é¢˜ | ç±»æ¯” | åæœ |
|---|---|---|
| Context Window æº¢å‡º | ä¹¦æ¡Œå †æ»¡äº†çº¸ï¼Œå†æ”¾ä¸€å¼ å°±å¡Œäº† | **ç›´æ¥æŠ¥é”™**ï¼Œä¸å¯æ¢å¤ |
| æ³¨æ„åŠ›åˆ†æ•£ | è€ƒè¯•æ—¶æ¡Œä¸Šæ”¾äº†æ¼«ç”»ä¹¦ | å›ç­”è´¨é‡**ä¸‹é™** |
| æˆæœ¬é£™å‡ | æ¯æ¬¡å¤å°éƒ½è¦å¤å°å…¨éƒ¨å†å²æ–‡ä»¶ | ğŸ’°ğŸ’°ğŸ’° |

### ç®¡ç†ç­–ç•¥çš„æ ¸å¿ƒæ€æƒ³ï¼šä¸»åŠ¨é—å¿˜

äººç±»ä¹Ÿä¸ä¼šè®°ä½æ¯å¥å¯¹è¯ï¼Œæˆ‘ä»¬ä¼š**è‡ªåŠ¨å‹ç¼©å’Œè¿‡æ»¤**ã€‚LLM éœ€è¦ä½ å¸®å®ƒåšè¿™ä»¶äº‹ï¼š

```python
# ç­–ç•¥ 1: æ»‘åŠ¨çª—å£ â€”â€” åªä¿ç•™æœ€è¿‘ N æ¡
messages = [system_msg] + messages[-20:]

# ç­–ç•¥ 2: Token é¢„ç®— â€”â€” ä¸è¶…è¿‡ X ä¸ª token
# ç­–ç•¥ 3: æ‘˜è¦æ›¿æ¢ â€”â€” ç”¨ LLM æŠŠæ—§å¯¹è¯å‹ç¼©æˆä¸€æ®µæ‘˜è¦

# ç¤ºæ„ï¼š
# åŸå§‹: [msg1, msg2, msg3, ..., msg50, msg51, msg52]
# å‹ç¼©å: [system_msg, summary("msg1-msg50çš„æ‘˜è¦"), msg51, msg52]
```

> ğŸ’¡ **è¦è®°ä½**ï¼šçŸ­æœŸè®°å¿†çš„æŒ‘æˆ˜ä¸æ˜¯"æ€ä¹ˆè®°ä½"ï¼Œè€Œæ˜¯"**æ€ä¹ˆèªæ˜åœ°é—å¿˜**"ã€‚

---

## 3ï¸âƒ£ é•¿æœŸè®°å¿† â€” è¯­ä¹‰è®°å¿†ï¼ˆSemantic Memoryï¼‰

### ä»€ä¹ˆæ˜¯è¯­ä¹‰è®°å¿†ï¼Ÿ

**è®°ä½äº‹å®å’Œæ¦‚å¿µ**ã€‚ä¸æ˜¯æŸæ¬¡å…·ä½“ç»å†ï¼Œè€Œæ˜¯æŠ½è±¡çš„çŸ¥è¯†ã€‚

| äººç±»çš„è¯­ä¹‰è®°å¿†        | Agent çš„è¯­ä¹‰è®°å¿†      |
| -------------- | ---------------- |
| "åœ°çƒç»•å¤ªé˜³è½¬"       | "ç”¨æˆ·å°æ˜å¯¹èŠ±ç”Ÿè¿‡æ•"      |
| "Python æ˜¯ç¼–ç¨‹è¯­è¨€" | "è¿™ä¸ªå…¬å¸çš„è´¢å¹´ä» 4 æœˆå¼€å§‹" |
| "æ³•å›½çš„é¦–éƒ½æ˜¯å·´é»"     | "ç”¨æˆ·åå¥½ç®€æ´çš„å›å¤é£æ ¼"    |

> âš ï¸ **è¯­ä¹‰è®°å¿† â‰  è¯­ä¹‰æœç´¢**ã€‚è¯­ä¹‰è®°å¿†æ˜¯å¿ƒç†å­¦æœ¯è¯­ï¼ˆå­˜äº‹å®ï¼‰ï¼Œè¯­ä¹‰æœç´¢æ˜¯æ£€ç´¢æŠ€æœ¯ï¼ˆç”¨ embedding æ‰¾ç›¸ä¼¼å†…å®¹ï¼‰ã€‚åˆ«æ··æ·†ï¼

### ä¸¤ç§å­˜å‚¨æ¨¡å¼ï¼šProfile vs Collection

è¿™æ˜¯æœ¬èŠ‚æœ€æ ¸å¿ƒçš„å¯¹æ¯”ï¼Œç”¨ä¸€ä¸ªç”Ÿæ´»ç±»æ¯”æ¥ç†è§£ï¼š

---

#### ğŸªª Profile æ¨¡å¼ â€” "ä¸€å¼ åç‰‡"

æŠŠæ‰€æœ‰å…³äºæŸä¸ªå®ä½“çš„ä¿¡æ¯ï¼Œç»´æŠ¤æˆ**ä¸€ä¸ª JSON æ–‡æ¡£**ï¼ŒæŒç»­æ›´æ–°ã€‚

```python
# Profile æ¨¡å¼ï¼šä¸€ä¸ªç”¨æˆ· = ä¸€ä¸ª JSON æ–‡æ¡£
user_profile = {
    "name": "å°æ˜",
    "language": "zh-CN",
    "tone_preference": "formal",     # ä¹‹å‰æ˜¯ casualï¼Œåæ¥æ›´æ–°äº†
    "allergies": ["peanut"],
    "favorite_topics": ["Python", "AI"],
    "last_updated": "2026-02-09"
}
```

**æ›´æ–°æµç¨‹**ï¼š

```
æ—§ Profile + æ–°å¯¹è¯ â†’ LLM ç”Ÿæˆæ–° Profile â†’ è¦†ç›–ä¿å­˜
```

```python
# ä¼ªä»£ç ï¼šæ›´æ–° Profile
prompt = f"""
å½“å‰ç”¨æˆ· Profile: {old_profile}
æœ€è¿‘çš„å¯¹è¯: {recent_conversation}

è¯·æ ¹æ®å¯¹è¯æ›´æ–° Profileï¼Œè¾“å‡ºæ–°çš„ JSONã€‚
"""
new_profile = llm.invoke(prompt)
store.put(namespace, "profile", new_profile)
```

**ä¼˜ç‚¹**ï¼šç»“æ„æ¸…æ™°ï¼Œä¸Šä¸‹æ–‡å®Œæ•´ï¼Œä¸€æ¬¡è¯»å–å°±æ‹¿åˆ°å…¨è²Œ
**ç¼ºç‚¹**ï¼šProfile å˜å¤§åï¼ŒLLM æ›´æ–°å®¹æ˜“å‡ºé”™ï¼ˆæ¼æ‰æ—§ä¿¡æ¯ã€æ ¼å¼é”™ä¹±ï¼‰

---

#### ğŸ“‚ Collection æ¨¡å¼ â€” "ä¸€ä¸ªæ–‡ä»¶å¤¹"

æ¯æ¡è®°å¿†æ˜¯æ–‡ä»¶å¤¹é‡Œçš„**ä¸€ä¸ªç‹¬ç«‹æ–‡ä»¶**ï¼Œä¸æ–­æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤ã€‚

```python
# Collection æ¨¡å¼ï¼šä¸€ä¸ªç”¨æˆ· = å¤šæ¡ç‹¬ç«‹è®°å¿†
memories = [
    {"id": "mem-001", "content": "ç”¨æˆ·åå«å°æ˜"},
    {"id": "mem-002", "content": "ç”¨æˆ·å¯¹èŠ±ç”Ÿè¿‡æ•"},
    {"id": "mem-003", "content": "ç”¨æˆ·å–œæ¬¢æ­£å¼çš„è¯­æ°”"},
    {"id": "mem-004", "content": "ç”¨æˆ·åœ¨å­¦ LangGraph"},
    # ... å¯ä»¥ä¸æ–­å¢åŠ 
]
```

**ä¼˜ç‚¹**ï¼š
* å•æ¡è®°å¿†å°è€Œç²¾ç¡®ï¼ŒLLM æ›´å®¹æ˜“ç”Ÿæˆ
* ä¸å®¹æ˜“ä¸¢å¤±ä¿¡æ¯ï¼ˆæ–°å¢æ¯”ä¿®æ”¹å®¹æ˜“ï¼‰
* å¬å›ç‡ï¼ˆrecallï¼‰æ›´é«˜

**ç¼ºç‚¹**ï¼š
* æ›´æ–°å¤æ‚â€”â€”è¦å†³å®šæ˜¯"æ–°å¢"è¿˜æ˜¯"ä¿®æ”¹å·²æœ‰çš„"è¿˜æ˜¯"åˆ é™¤æ—§çš„"
* æœç´¢å¤æ‚â€”â€”ç”¨å“ªæ¡ï¼Ÿéœ€è¦è¯­ä¹‰æœç´¢ + è¿‡æ»¤
* ç¼ºä¹å…¨å±€è§†è§’â€”â€”å•æ¡è®°å¿†å¯èƒ½ç¼ºå°‘ä¸Šä¸‹æ–‡å…³è”

---

#### ğŸ¤” æ€ä¹ˆé€‰ï¼Ÿ

| ç»´åº¦ | Profile | Collection |
|---|---|---|
| ä¿¡æ¯é‡ | é€‚åˆå°‘é‡ã€ç»“æ„åŒ–çš„ä¿¡æ¯ | é€‚åˆå¤§é‡ã€æŒç»­å¢é•¿çš„ä¿¡æ¯ |
| æ›´æ–°é¢‘ç‡ | ä½é¢‘æ›´æ–° | é«˜é¢‘æ›´æ–° |
| ä¿¡æ¯å…³è”æ€§ | ä¿¡æ¯ä¹‹é—´æœ‰å¼ºå…³è” | ä¿¡æ¯ç›¸å¯¹ç‹¬ç«‹ |
| ç±»æ¯” | ç®€å†/ä¸ªäººèµ„æ–™å¡ | ä¾¿åˆ©è´´å¢™ |

**å®é™…é¡¹ç›®ä¸­**ï¼šå¯ä»¥ä¸¤è€…ç»“åˆã€‚æ¯”å¦‚æ ¸å¿ƒå±æ€§ç”¨ Profileï¼Œç»†ç¢çš„åå¥½ç”¨ Collectionã€‚

---

## 4ï¸âƒ£ é•¿æœŸè®°å¿† â€” æƒ…æ™¯è®°å¿†ï¼ˆEpisodic Memoryï¼‰

### ä»€ä¹ˆæ˜¯æƒ…æ™¯è®°å¿†ï¼Ÿ

**è®°ä½å…·ä½“çš„ç»å†**ã€‚ä¸æ˜¯æŠ½è±¡äº‹å®ï¼Œè€Œæ˜¯"é‚£æ¬¡æˆ‘åšäº†ä»€ä¹ˆï¼Œç»“æœå¦‚ä½•"ã€‚

| äººç±»çš„æƒ…æ™¯è®°å¿† | Agent çš„æƒ…æ™¯è®°å¿† |
|---|---|
| "ä¸Šæ¬¡æˆ‘èµ°é‚£æ¡è·¯å µè½¦äº†" | "ä¸Šæ¬¡ç”¨æˆ·é—®éƒ¨ç½²é—®é¢˜æ—¶ï¼Œæˆ‘ç”¨ Docker æ–¹æ¡ˆè§£ç­”æ•ˆæœå¾ˆå¥½" |
| "ç¬¬ä¸€æ¬¡éª‘è‡ªè¡Œè½¦æ‘”äº†" | "ä¸Šæ¬¡è°ƒç”¨ API X è¶…æ—¶äº†ï¼Œæ¢æˆ API Y æˆåŠŸäº†" |

### å®ç°æ–¹å¼ï¼šFew-shot Example Prompting

æƒ…æ™¯è®°å¿†åœ¨å®è·µä¸­ï¼Œæœ€å¸¸è§çš„å®ç°å°±æ˜¯ **few-shot ç¤ºä¾‹**â€”â€”æŠŠè¿‡å»æˆåŠŸçš„"ç»éªŒ"ä½œä¸ºç¤ºä¾‹å–‚ç»™ LLMã€‚

```python
# å‡è®¾æˆ‘ä»¬å­˜äº†ä¸€äº›è¿‡å»çš„æˆåŠŸç»éªŒ
past_experiences = [
    {
        "user_input": "å¸®æˆ‘å†™ä¸ªæ’åºç®—æ³•",
        "good_response": "è¿™æ˜¯å¿«é€Ÿæ’åºçš„ Python å®ç°...(å…·ä½“ä»£ç )"
    },
    {
        "user_input": "è§£é‡Šä¸€ä¸‹è£…é¥°å™¨",
        "good_response": "è£…é¥°å™¨å°±åƒç¤¼ç‰©åŒ…è£…çº¸...(ç”ŸåŠ¨ç±»æ¯”+ä»£ç )"
    }
]

# æ„é€  prompt æ—¶ï¼ŒæŠŠç›¸å…³ç»éªŒä½œä¸º few-shot ç¤ºä¾‹
prompt = f"""
ä»¥ä¸‹æ˜¯ä¸€äº›å¥½çš„å›ç­”ç¤ºä¾‹ï¼š

ç¤ºä¾‹ 1:
ç”¨æˆ·: {past_experiences[0]["user_input"]}
å›ç­”: {past_experiences[0]["good_response"]}

ç¤ºä¾‹ 2:
ç”¨æˆ·: {past_experiences[1]["user_input"]}
å›ç­”: {past_experiences[1]["good_response"]}

ç°åœ¨è¯·å›ç­”ï¼š
ç”¨æˆ·: {current_user_input}
"""
```

**æ ¸å¿ƒæ€æƒ³**ï¼šæœ‰æ—¶å€™"åšç»™ä½ çœ‹"æ¯”"å‘Šè¯‰ä½ è§„åˆ™"æ›´æœ‰æ•ˆã€‚LLM ä»ä¾‹å­ä¸­å­¦ä¹ çš„èƒ½åŠ›éå¸¸å¼ºã€‚

> ğŸ’¡ **å­˜å‚¨æ–¹å¼çš„é€‰æ‹©**ï¼š
> * ç”¨ LangGraph **Store** â†’ çµæ´»ï¼Œä»£ç æ§åˆ¶
> * ç”¨ LangSmith **Dataset** â†’ æ›´é€‚åˆå’Œè¯„ä¼°ç³»ç»Ÿç»“åˆï¼Œå†…ç½® BM25 ç›¸ä¼¼åº¦æ£€ç´¢

---

## 5ï¸âƒ£ é•¿æœŸè®°å¿† â€” ç¨‹åºè®°å¿†ï¼ˆProcedural Memoryï¼‰

### ä»€ä¹ˆæ˜¯ç¨‹åºè®°å¿†ï¼Ÿ

**è®°ä½è§„åˆ™å’ŒæŠ€èƒ½**ã€‚å°±åƒä½ éª‘è‡ªè¡Œè½¦â€”â€”ä½ ä¸ç”¨æ¯æ¬¡éƒ½"æƒ³"æ€ä¹ˆéª‘ï¼Œèº«ä½“è‡ªåŠ¨çŸ¥é“ã€‚

| äººç±»çš„ç¨‹åºè®°å¿† | Agent çš„ç¨‹åºè®°å¿† |
|---|---|
| éª‘è‡ªè¡Œè½¦çš„è‚Œè‚‰è®°å¿† | æ¨¡å‹æƒé‡ï¼ˆè®­ç»ƒå¥½çš„èƒ½åŠ›ï¼‰ |
| æ‰“å­—æ—¶æ‰‹æŒ‡è‡ªåŠ¨ç§»åŠ¨ | Agent ä»£ç é€»è¾‘ |
| åšé¥­çš„æ­¥éª¤å’Œä¹ æƒ¯ | **System Prompt**ï¼ˆæœ€å¸¸è¢«ä¿®æ”¹çš„éƒ¨åˆ†ï¼‰ |

### å®ç°æ–¹å¼ï¼šè‡ªæˆ‘ä¿®æ”¹ Promptï¼ˆReflectionï¼‰

åœ¨å®è·µä¸­ï¼ŒAgent ä¸€èˆ¬ä¸ä¼šæ”¹è‡ªå·±çš„ä»£ç æˆ–æ¨¡å‹æƒé‡ï¼Œä½†**å¯ä»¥æ”¹è‡ªå·±çš„ Prompt**ï¼

è¿™å°±åƒä¸€ä¸ªå¨å¸ˆæ ¹æ®é£Ÿå®¢åé¦ˆè°ƒæ•´è‡ªå·±çš„çƒ¹é¥ªä¹ æƒ¯ï¼š

```
ç¬¬1å¤©: "æˆ‘æŒ‰ç…§æ ‡å‡†é£Ÿè°±åšäº†çº¢çƒ§è‚‰"
é£Ÿå®¢åé¦ˆ: "å¤ªå’¸äº†"
ç¬¬2å¤©: "æˆ‘è®°ä½äº†ï¼Œå°‘æ”¾ç›" â† ä¿®æ”¹äº†è‡ªå·±çš„"çƒ¹é¥ªè§„åˆ™"
```

### ä»£ç ç¤ºä¾‹

```python
# èŠ‚ç‚¹1: ä½¿ç”¨å½“å‰æŒ‡ä»¤æ¥å›ç­”
def call_model(state: State, store: BaseStore):
    # ä» Store è¯»å–å½“å‰çš„æŒ‡ä»¤
    namespace = ("agent_instructions",)
    instructions = store.get(namespace, key="agent_a")
    
    # ç”¨æŒ‡ä»¤æ„é€  prompt
    prompt = f"""
    ä½ çš„è¡Œä¸ºå‡†åˆ™ï¼š
    {instructions.value["instructions"]}
    
    ç”¨æˆ·æ¶ˆæ¯ï¼š
    {state["messages"][-1].content}
    """
    response = llm.invoke(prompt)
    return {"messages": [response]}


# èŠ‚ç‚¹2: æ ¹æ®åé¦ˆæ›´æ–°æŒ‡ä»¤
def update_instructions(state: State, store: BaseStore):
    # è¯»å–å½“å‰æŒ‡ä»¤
    namespace = ("agent_instructions",)
    current = store.get(namespace, key="agent_a")
    
    # è®© LLM åæ€å¹¶æ”¹è¿›æŒ‡ä»¤
    prompt = f"""
    ä½ å½“å‰çš„è¡Œä¸ºå‡†åˆ™æ˜¯ï¼š
    {current.value["instructions"]}
    
    ä»¥ä¸‹æ˜¯æœ€è¿‘çš„å¯¹è¯ï¼ˆåŒ…å«ç”¨æˆ·åé¦ˆï¼‰ï¼š
    {state["messages"]}
    
    è¯·æ ¹æ®ç”¨æˆ·åé¦ˆï¼Œæ”¹è¿›ä½ çš„è¡Œä¸ºå‡†åˆ™ã€‚
    """
    output = llm.invoke(prompt)
    
    # ä¿å­˜æ–°æŒ‡ä»¤
    store.put(
        ("agent_instructions",), 
        "agent_a", 
        {"instructions": output.content}
    )
```

**æµç¨‹å›¾**ï¼š

```
ç”¨æˆ·åé¦ˆ â†’ update_instructions â†’ Store(æ–° Prompt) â†’ call_model è¯»å–æ–° Prompt â†’ æ›´å¥½çš„å›ç­”
    â†‘                                                                           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> ğŸ’¡ **ç°å®æ¡ˆä¾‹**ï¼šæ–‡æ¡£é‡Œæåˆ°äº†ä¸€ä¸ª Tweet ç”Ÿæˆå™¨ã€‚å†™è®ºæ–‡æ‘˜è¦çš„ prompt å¾ˆéš¾ä¸€æ¬¡å†™å¥½ï¼Œä½†ç”¨æˆ·å¯ä»¥è½»æ¾åœ°è¯´"è¿™æ¡æ¨æ–‡å¤ªé•¿äº†"ã€"ä¸å¤Ÿå¸å¼•äºº"ï¼ŒAgent å°±æ®æ­¤ä¿®æ”¹è‡ªå·±çš„æ‘˜è¦ç”Ÿæˆç­–ç•¥ã€‚

---

## 6ï¸âƒ£ å†™å…¥æ—¶æœºï¼šHot Path vs Background

è¿™æ˜¯ä¸€ä¸ª**æ¶æ„å†³ç­–**ï¼Œç±»æ¯”å¦‚ä¸‹ï¼š

### ğŸ”¥ Hot Path â€” "è¾¹èŠè¾¹è®°"

å°±åƒä½ å’Œæœ‹å‹èŠå¤©æ—¶ï¼Œ**å½“åœº**åœ¨ç¬”è®°æœ¬ä¸Šè®°ä¸‹é‡è¦ä¿¡æ¯ã€‚

```
ç”¨æˆ·: æˆ‘ä¸‹å‘¨è¦å»ä¸œäº¬å‡ºå·®
Agent: (å¿ƒæƒ³ï¼šè¿™ä¸ªè¦è®°ä½ï¼) 
       â†’ è°ƒç”¨ save_memory å·¥å…·
       â†’ å­˜å‚¨: "ç”¨æˆ·ä¸‹å‘¨å»ä¸œäº¬å‡ºå·®"
       â†’ å›å¤: "å¥½çš„ï¼éœ€è¦æˆ‘å¸®ä½ æŸ¥ä¸œäº¬çš„å¤©æ°”æˆ–é¤å…æ¨èå—ï¼Ÿ"
```

| âœ… ä¼˜ç‚¹ | âŒ ç¼ºç‚¹ |
|---|---|
| å®æ—¶æ›´æ–°ï¼Œç«‹å³å¯ç”¨ | å¢åŠ å“åº”å»¶è¿Ÿ |
| ç”¨æˆ·å¯æ„ŸçŸ¥ï¼ˆé€æ˜ï¼‰ | Agent è¦"ä¸€å¿ƒå¤šç”¨" |
| æ–°è®°å¿†ç«‹åˆ»ç”Ÿæ•ˆ | éœ€è¦é¢å¤–çš„ toolï¼ˆå¦‚ `save_memories`ï¼‰ |

**ä»£è¡¨äº§å“**ï¼šChatGPT çš„è®°å¿†åŠŸèƒ½å°±æ˜¯ Hot Pathï¼Œå®ƒä½¿ç”¨ `save_memories` å·¥å…·åœ¨å¯¹è¯ä¸­å†³å®šå­˜ä»€ä¹ˆã€‚

---

### ğŸŒ™ Background â€” "äº‹åæ•´ç†"

å°±åƒä½ ç»“æŸä¸€å¤©çš„ä¼šè®®åï¼Œ**æ™šä¸Šå›å®¶æ•´ç†ç¬”è®°**ã€‚

```
ç”¨æˆ·å’Œ Agent æ­£å¸¸å¯¹è¯ï¼ˆä¸å—æ‰“æ‰°ï¼‰
        â†“
å¯¹è¯ç»“æŸåï¼Œåå°å¼‚æ­¥ä»»åŠ¡å¯åŠ¨
        â†“
åˆ†æå¯¹è¯ â†’ æå–å€¼å¾—è®°ä½çš„ä¿¡æ¯ â†’ å­˜å…¥ Store
```

| âœ… ä¼˜ç‚¹ | âŒ ç¼ºç‚¹ |
|---|---|
| ä¸å½±å“ä¸»æµç¨‹å»¶è¿Ÿ | æ–°è®°å¿†ä¸èƒ½ç«‹å³ä½¿ç”¨ |
| åº”ç”¨é€»è¾‘å’Œè®°å¿†é€»è¾‘åˆ†ç¦» | éœ€è¦å†³å®š"å¤šä¹…è·‘ä¸€æ¬¡" |
| Agent å¯ä»¥ä¸“æ³¨å½“å‰ä»»åŠ¡ | å…¶ä»– Thread å¯èƒ½æš‚æ—¶ç¼ºå°‘æœ€æ–°ä¸Šä¸‹æ–‡ |

**è§¦å‘ç­–ç•¥**ï¼š
* â° å®šæ—¶è§¦å‘ï¼ˆå¦‚æ¯ 5 åˆ†é’Ÿï¼‰
* ğŸ“… Cron è°ƒåº¦ï¼ˆå¦‚æ¯å¤©å‡Œæ™¨ï¼‰
* ğŸ–±ï¸ æ‰‹åŠ¨è§¦å‘ï¼ˆç”¨æˆ·ç‚¹"ä¿å­˜"æˆ–å¯¹è¯ç»“æŸæ—¶ï¼‰

---

### æ€ä¹ˆé€‰ï¼Ÿ

```
éœ€è¦å®æ—¶æ€§ï¼Ÿ â”€â”€æ˜¯â”€â”€â†’ ğŸ”¥ Hot Path
     â”‚
     å¦
     â”‚
     â†“
å¯¹å»¶è¿Ÿæ•æ„Ÿï¼Ÿ â”€â”€æ˜¯â”€â”€â†’ ğŸŒ™ Background
     â”‚
     å¦
     â”‚
     â†“
ä¸¤è€…ç»“åˆï¼šå…³é”®ä¿¡æ¯ Hot Pathï¼Œå…¶ä½™ Background
```

---

## 7ï¸âƒ£ å­˜å‚¨æœºåˆ¶ï¼šStore API å®æˆ˜

æœ€åï¼Œæ‰€æœ‰é•¿æœŸè®°å¿†éƒ½éœ€è¦ä¸€ä¸ª**ç‰©ç†å­˜å‚¨**ã€‚LangGraph çš„ Store å°±æ˜¯è¿™ä¸ªå­˜å‚¨å±‚ã€‚

### æ ¸å¿ƒæ¦‚å¿µ

```
Store
  â””â”€â”€ Namespace (ç±»ä¼¼æ–‡ä»¶å¤¹ï¼Œæ”¯æŒå±‚çº§)
        â””â”€â”€ Key (ç±»ä¼¼æ–‡ä»¶å)
              â””â”€â”€ Value (JSON æ–‡æ¡£)
```

æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ª**æ–‡ä»¶ç³»ç»Ÿ**ï¼š

```
/my-user/chitchat/          â† namespace = ("my-user", "chitchat")
    â”œâ”€â”€ a-memory.json        â† key = "a-memory"
    â”œâ”€â”€ b-memory.json        â† key = "b-memory"
    â””â”€â”€ ...

/my-user/work/               â† namespace = ("my-user", "work")
    â”œâ”€â”€ project-notes.json
    â””â”€â”€ ...

/org-abc/shared/              â† namespace = ("org-abc", "shared")
    â””â”€â”€ guidelines.json
```

### å®Œæ•´ä»£ç ç¤ºä¾‹

```python
from langgraph.store.memory import InMemoryStore

# 1. åˆ›å»º Storeï¼ˆç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨æ•°æ®åº“åç«¯ï¼‰
def embed(texts: list[str]) -> list[list[float]]:
    # å®é™…é¡¹ç›®ä¸­æ›¿æ¢ä¸ºçœŸæ­£çš„ embedding å‡½æ•°
    return [[1.0, 2.0] * len(texts)]

store = InMemoryStore(
    index={"embed": embed, "dims": 2}  # å¯ç”¨è¯­ä¹‰æœç´¢
)

# 2. å®šä¹‰ namespaceï¼ˆç”¨æˆ· ID + åº”ç”¨åœºæ™¯ï¼‰
user_id = "xiaoming"
context = "chitchat"
namespace = (user_id, context)

# 3. å†™å…¥è®°å¿†
store.put(
    namespace,
    "preferences",  # key
    {
        "rules": [
            "ç”¨æˆ·å–œæ¬¢ç®€çŸ­ç›´æ¥çš„è¯­è¨€",
            "ç”¨æˆ·åªè¯´ä¸­æ–‡å’Œ Python",
        ],
        "tone": "formal",
    },
)

# 4. ç²¾ç¡®è¯»å–ï¼ˆçŸ¥é“ keyï¼‰
item = store.get(namespace, "preferences")
print(item.value)
# â†’ {"rules": [...], "tone": "formal"}

# 5. æœç´¢ï¼ˆä¸çŸ¥é“å…·ä½“ keyï¼Œä½†çŸ¥é“å¤§æ¦‚å†…å®¹ï¼‰
results = store.search(
    namespace,
    filter={"tone": "formal"},       # å†…å®¹è¿‡æ»¤
    query="language preferences",     # è¯­ä¹‰æœç´¢
)
```

### ä¸‰ç§è®¿é—®æ–¹å¼å¯¹æ¯”

| æ–¹å¼ | ç”¨é€” | ç±»æ¯” |
|---|---|---|
| `store.get(namespace, key)` | ç²¾ç¡®è·å–æŸæ¡è®°å¿† | æ‰“å¼€ä¹¦æ¶ä¸Šç‰¹å®šçš„é‚£æœ¬ä¹¦ |
| `store.search(namespace, query=...)` | è¯­ä¹‰æœç´¢ç›¸å…³è®°å¿† | åœ¨å›¾ä¹¦é¦†æœç´¢"å…³äº AI çš„ä¹¦" |
| `store.search(namespace, filter=...)` | æŒ‰å­—æ®µè¿‡æ»¤ | ç­›é€‰"2026 å¹´å‡ºç‰ˆçš„ä¹¦" |

---

## ğŸ¯ ç»ˆææ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LangGraph Memory å…¨æ™¯                      â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ çŸ­æœŸè®°å¿†     â”‚    â”‚ é•¿æœŸè®°å¿†                              â”‚ â”‚
â”‚  â”‚             â”‚    â”‚                                      â”‚ â”‚
â”‚  â”‚ State       â”‚    â”‚  è¯­ä¹‰è®°å¿†    æƒ…æ™¯è®°å¿†     ç¨‹åºè®°å¿†      â”‚ â”‚
â”‚  â”‚ Checkpointerâ”‚    â”‚  (äº‹å®)     (ç»éªŒ)      (è§„åˆ™)       â”‚ â”‚
â”‚  â”‚             â”‚    â”‚  Profile/   Few-shot    Prompt       â”‚ â”‚
â”‚  â”‚ ç®¡ç†:       â”‚    â”‚  Collection  Examples   Reflection   â”‚ â”‚
â”‚  â”‚ â€¢ æ»‘åŠ¨çª—å£  â”‚    â”‚                                      â”‚ â”‚
â”‚  â”‚ â€¢ Token é™åˆ¶â”‚    â”‚  å†™å…¥: Hot Path / Background          â”‚ â”‚
â”‚  â”‚ â€¢ æ‘˜è¦å‹ç¼©  â”‚    â”‚  å­˜å‚¨: Store (namespace + key + JSON) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®°å¿†ä¸‰é—®ï¼ˆè®¾è®¡é•¿æœŸè®°å¿†æ—¶é—®è‡ªå·±ï¼‰

1. **What** â€” è®°ä»€ä¹ˆç±»å‹ï¼Ÿäº‹å®ï¼ˆè¯­ä¹‰ï¼‰/ ç»éªŒï¼ˆæƒ…æ™¯ï¼‰/ è§„åˆ™ï¼ˆç¨‹åºï¼‰
2. **When** â€” ä»€ä¹ˆæ—¶å€™å†™ï¼Ÿå®æ—¶ï¼ˆHot Pathï¼‰/ å¼‚æ­¥ï¼ˆBackgroundï¼‰
3. **How** â€” æ€ä¹ˆç»„ç»‡ï¼ŸProfileï¼ˆå•æ–‡æ¡£ï¼‰/ Collectionï¼ˆå¤šæ–‡æ¡£ï¼‰
